{% extends 'index.html' %}

{% block content %}
<div class="max-w-4xl mx-auto mt-10 p-6 bg-white rounded-xl shadow-md border border-gray-200">
    <h1 class="text-3xl font-bold mb-6 text-[#0d1b2a]">ðŸ“¨ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ÙˆØ§Ø±Ø¯Ø©</h1>

    <!-- Loop through threads (user, last_message) -->
    {% for user, last_message in threads %}
        <div class="mb-5 p-4 rounded-lg border {% if not last_message.is_read and last_message.receiver == request.user %}bg-gray-50 hover:shadow-lg{% else %}bg-gray-100{% endif %} transition-all duration-300">
            
            <!-- Message Header -->
            <div class="flex justify-between items-center mb-3">
                <p class="font-semibold text-[#0d1b2a] text-lg">{{ user.username }}</p>
                <span class="text-sm text-gray-500">{{ last_message.timestamp|date:"Y/m/d H:i" }}</span>
            </div>

            <!-- Message Content -->
            <p class="text-gray-800 leading-relaxed">{{ last_message.content|truncatechars:80 }}</p>

            <!-- Read/Unread indicator -->
            {% if not last_message.is_read and last_message.receiver == request.user %}
                <p class="mt-2 text-sm text-yellow-600 font-semibold">Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©</p>
            {% endif %}

            <!-- Action Buttons -->
            <div class="flex gap-5 mt-4">
                <a href="{% url 'chat_detail' user.id %}" 
                class="bg-[#e76f51] text-white py-2 px-5 rounded-md hover:bg-[#f7c6a3] transition-all duration-300">
                <i class="fas fa-comment-dots"></i> Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
             </a>
             
            </div>
        </div>
    {% empty %}
        <p class="text-gray-600">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø³Ø§Ø¦Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹.</p>
    {% endfor %}
</div>
{% endblock %}
